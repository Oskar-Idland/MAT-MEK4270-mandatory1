\documentclass{article}
\usepackage{amsmath}
\usepackage{titlesec}
% \usepackage[mathletters]{ucs}
\usepackage{mathtools} %for \abs{x}
\usepackage[warnings-off={mathtools-colon,mathtools-overbracket}]{unicode-math}
% \setmainfont{TeX Gyre Schola}
% \setmathfont{TeX Gyre Schola Math}
% \usepackage[utf8x]{inputenc}
% \usepackage{fontenc}
\usepackage[margin=1.5in]{geometry}
\usepackage{enumerate}
\newtheorem{theorem}{Theorem}
\usepackage[dvipsnames]{xcolor}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\setlength{\parindent}{0cm}
\usepackage{graphics}
\usepackage{graphicx} % Required for including images
\usepackage{subcaption}
\usepackage{bigintcalc}
\usepackage{pythonhighlight} %for pythonkode \begin{python}   \end{python}
\usepackage{appendix}
\usepackage{arydshln}
\usepackage{physics}
\usepackage{booktabs} 
\usepackage{adjustbox}
\usepackage{mdframed}
\usepackage{relsize}
\usepackage{physics}
\usepackage[thinc]{esdiff}
\usepackage{esint}  %for lukket-linje-integral
\usepackage{xfrac} %for sfrac
\usepackage[colorlinks=true,linktoc=page]{hyperref} %for linker, må ha med hypersetup
\usepackage[noabbrev, nameinlink]{cleveref} % to be loaded after hyperref
% \usepackage{amssymb} %\mathbb{R} for reelle tall, \mathcal{B} for "matte"-font
\usepackage{listings} %for kode/lstlisting
\usepackage{verbatim}
\usepackage{graphicx,wrapfig,lipsum,caption} %for wrapping av bilder
\usepackage[english]{babel}
\usepackage{cancel}
% \usepackage{alphabeta}
\usepackage{mhchem} % for atom notasjon
% \definecolor{codegreen}{rgb}{0,0.6,0}
% \definecolor{codegray}{rgb}{0.5,0.5,0.5}
% \definecolor{codepurple}{rgb}{0.58,0,0.82}
% \definecolor{backcolour}{rgb}{0.95,0.95,0.92}
% \lstdefinestyle{mystyle}{
%     backgroundcolor=\color{backcolour},   
%     commentstyle=\color{codegreen},
%     keywordstyle=\color{magenta},
%     numberstyle=\tiny\color{codegray},
%     stringstyle=\color{codepurple},
%     basicstyle=\ttfamily\footnotesize,
%     breakatwhitespace=false,         
%     breaklines=true,                 
%     captionpos=b,                    
%     keepspaces=true,                 
%     numbers=left,                    
%     numbersep=5pt,                  
%     showspaces=false,                
%     showstringspaces=false,
%     showtabs=false,                  
%     tabsize=2
% }

% \lstset{style=mystyle}
\author{Oskar Idland}
\title{Mandatory Assignment 1} 
\date{}
\begin{document}
\maketitle
% \newpage

\section*{Repo}
The code for this assignment can be found at: 

\url{https://github.com/Oskar-Idland/MAT-MEK4270-mandatory1}

\section*{Dirichlet Problem}
The Dirichlet problem is given by:
\[
u(x, y, t) = \sin(k_xx) \sin(k_yy) \cos(ωt).
\]
Using that 
\[
\frac{∂^2u}{∂t^2} = c^2∇^2u 
\]
we get:
\[
\frac{∂^2u}{∂t^2} = -ω^2 \sin(k_xx) \sin(k_yy) \cos(ωt)
\]
\[
\frac{∂^2u}{∂t^2} = c^2 \left(\frac{∂^2u}{∂x^2} + \frac{∂^2u}{∂y^2}\right) = -c^2 \left(-k_x^2 \sin (k_xx) \sin(x_yy) \cos(ωt)  -k_y^2 \sin (k_xx) \sin(x_yy) \cos(ωt)\right)
\]
\[
ω^2 = c^2(k_x^2 + k_y^2) ⟹ ω = c\sqrt{k_x^2 + k_y^2}.
\]


\section*{Exact Solutions}
To find the relation between $ω$, $k_x$ and $k_y$ we use the exact solution:
\[
u(x, y, t) = e^{i(k_xx + k_yy - ωt)}
\]
\[
\frac{∂^2u}{∂ t^2} = c^2∇^2u
\]
\[
\frac{∂^2u}{∂t^2} = c^2 \left(\frac{∂^2u}{∂x^2} + \frac{∂u}{∂y}\right)u
\]
\[
\frac{∂^2u}{∂ x^2} = -k_x^2 e^{i(k_xx + k_yy - ωt)}
\]
\[
\frac{∂^2u}{∂ y^2} = -k_y^2 e^{i(k_xx + k_yy - ωt)}.
\]
This shows their relationship to be: 
\[
ω^2 = c^2(k_x^2 + k_y^2) ⟹ ω = c\sqrt{k_x^2 + k_y^2}.
\]

\section*{Dispersion Coefficient $ω$}
If we assume that $k_x = k_y = k$, and $m_x = m_y$, we get the following discreet solution:
\[
u^{n}_{ij} = e^{i(kh(i + j) - \tilde{ω}nΔt)}.
\]
Using equation 1.3 from the assignment, we get:
\[
\frac{u^{n+1}_{ij} - 2u^{n}_{ij} + u^{n-1}_{ij}}{Δt^2} = c^2 \left( \frac{u^{n}_{i+1, j} - 2u^{n}_{ij} + u^{n}_{i-1, j}}{h^2} +  \frac{u^{n}_{i, j+1} - 2u^{n}_{ij} + u^{n}_{i, j-1}}{h^2}\right). 
\]
Adding this to the left-hand side of the equation for $u^{n}_{ij}$, we get:
\[
\frac{u^{n+1}_{ij} - 2u^{n}_{ij} + u^{n-1}_{ij}}{Δt^2} = \frac{e^{ikh(i + j)}}{Δ^2} \left( e^{i\tilde{ω}(n+1)Δt} - 2e^{-i\tilde{ω}} + e^{-i\tilde{ω}(n-1Δt}\right) 
\]
\[
\frac{u^{n+1}_{ij} - 2u^{n}_{ij} + u^{n-1}_{ij}}{Δt^2} = \frac{e^{ikh(i + j)}}{Δ^2} \left( e^{i\tilde{ω}Δt} - 2 + e^{-i\tilde{ω}Δt}\right). 
\]
Doing the same for the right-hand side of the equation for $u^{n}_{ij}$, we get:
\[
\frac{u^{n}_{i+1, j} - 2u^{n}_{ij} + u^{n}_{i-1, j}}{h^2} = \frac{e^{i \tilde{ω}nΔt}}{h^2} \left(e^{ikh(i+1+j)} - 2e^{ikh(i+j)} + e^{ikh(i-1+j)}\right)
\]
\[
\frac{u^{n}_{i+1, j} - 2u^{n}_{ij} + u^{n}_{i-1, j}}{h^2} = \frac{e^{i(kh(i + j) - \tilde{ω}nΔt)}}{h^2} \left(e^{ikh} - 2 + e^{-ikh}\right). 
\]
Combining these results, we get:
\[
\frac{e^{i(kh(i + j) - \tilde{ω}nΔt)}}{Δ^2} \left( e^{i\tilde{ω}Δt} - 2 + e^{-i\tilde{ω}Δt}\right) = c^2 \frac{e^{-i(\tilde{ω}nΔt - kh(i+j))}}{h^2} \left(e^{ikh} - 2 + e^{-ikh} + e^{ikh} - 2 + e^{-ikh}\right).
\]
Simplifying this, we get:
\[
\frac{e^{-i \tilde{ω}Δt} - 2 + e^{i \tilde{ω}Δt}}{Δt^2} = 2c^2 \frac{e^{ikh} - 2 + e^{-ikh}}{h^2}. 
\]
Using the CLF number $C = cΔt/h = 1/\sqrt{2}$:
\[
e^{i \tilde{ω}Δt} - 2 + e^{i \tilde{ω}Δt} = 2C \left(e^{ikh} - 2 + e^{-ikh}\right)
\]
\[
2 \cos(\tilde{ω}Δt) - 2 = 2C^2 \left(2 \cos(kh) - 2\right)
\]
\[
\cos(\tilde{ω}Δt) = 1 + 2C^2 \cos(kh) - 2C^2
\]
\[
\cos(\tilde{ω}Δt) = \cos(kh) 
\]


\end{document}